<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CS 184: Computer Graphics and Imaging, Spring 2023</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="36a93455-7c8f-4ce0-ba4f-de9bf7f019a1" class="page sans"><header><h1 class="page-title">CS 184: Computer Graphics and Imaging, Spring 2023</h1></header><div class="page-body"><h1 id="30bc9263-ca7b-4346-94bc-2b181d5529e0" class="">Project 3-1: Path Tracer</h1><h2 id="70a5be8e-938e-4896-b352-69c56f891bc8" class="">Srisai Nachuri, Maddy Chen</h2><p id="47c6ba7c-aa94-488b-ad8d-071b71ead685" class="">
</p><h2 id="c6dbd04e-58f6-4207-966d-ce589b809fdf" class="">Overview</h2><p id="f4978447-7436-4df5-8fa1-f6fbb8d5b40e" class="">In this project, we implemented a renderer that uses a pathtracing algorithm to render images by shooting rays at the scene to estimate the radiance at each pixel location. We also used the bounding volume hierarchy (BVH) acceleration structure to optimize our ray tracing and lighting calculations to calculate estimates of radiance on different material types based on Lambertian diffuse reflection.</p><p id="b5034e12-e689-47a1-a42c-d2e8a8e706b9" class="">In Part 1, we started with the building block of generating a ray from our camera onto a pixel, converting between the image space and camera space coordinates of pixels. We then generated multiple samples per pixel by shooting rays through a random location within the pixel to calculate the pixel’s radiance. We also implemented ray-triangle and ray-sphere intersection tests in this part, so rays can be tested on primitives in the scene.</p><p id="125df891-f200-4823-819a-7efd2fbee8d2" class="">In Part 2, we implemented a BVH acceleration structure, which is important for speeding up our rendering process by eliminating unnecessary intersection calculations. To construct a BVH, we took all of our primitives in the scene and recursively split the primitives into a tree of bounding boxes until each leaf node only had a few primitives. To utilize the BVH, we wrote a ray-bounding box intersection test and used the bounding box intersection test to help us recurse down the BVH tree and only check for primitive intersections in leaf nodes that the leaf node bounding box and the ray intersects with.</p><p id="1218caaf-4a16-424d-92a1-bb77eab19758" class="">In Part 3, we implemented the bidirectional scattering distribution function (BSDF) for diffuse materials, which was used for calculating radiance through reflection. The diffuse BSDF represents a material that scatters light equally in all directions. We also implemented zero-bounce illumination, which is the light that reaches the camera directly, and direct illumination, which is zero-bounce illumination and one-bounce illumination. One-bounce illumination was written in two ways: calculating lighting with uniform hemisphere sampling and with importance sampling light objects in the scene. One-bounce illumination allows us to render parts of an image that reflect light from light sources, completing the task of direct illumination. </p><p id="7a879b08-8825-4ac3-a698-7ef2234c6186" class="">In Part 4, we built upon our diffuse BSDF by also sampling the incoming light ray. We then implemented global illumination, which is the combination of zero-bounce, one-bounce, and two+ bounce illumination, allowing us to combine the direct illumination with indirect illumination. We wrote the function <code>at_least_one_bounce</code> to recursively calculate radiance contributions from light that bounces multiple times from a light source. This allowed us to better capture the brightness of images that results from form light bouncing off multiple surfaces.</p><p id="cddbb12e-9649-4432-a957-097c6eb07293" class="">Lastly, in Part 5, we implemented the adaptive sampling optimization. Adaptive sampling will take more samples of pixels that take longer to converge, and fewer samples of pixels that converge faster. This avoids having a lot of (what could be considered) unnecessary samples and we also tracked sample numbers to generate heat maps of how many times we were sampling pixels.</p><p id="09cc2972-6653-42c2-a8bc-8db7bb2a4740" class="">This project was very rewarding as we were able to render more complete images as we progressed through each part, and it was cool to see how we were eventually able to incorporate light bouncing around in the scenes to improve the overall lighting of the images. While rendering at times was very slow, it was interesting to observe the different effects that the rendering options had on the outcomes.</p><h2 id="432f0882-e18c-41bd-b4eb-b9bc92981b95" class="">Part 1: Ray Generation and Scene Intersection</h2><p id="33365637-3787-4f2a-a7c7-f9b742c2c560" class="">
</p><p id="1dbc28e8-eddd-42d9-9264-d611b2f31cd6" class=""><em>Walk through the ray generation and primitive intersection parts of the rendering pipeline.</em></p><p id="51fe5762-b696-4509-af40-795dcf4a14fd" class=""><strong>Ray Generation:</strong></p><p id="07618482-7b16-4096-9446-05c60dd061c5" class="">At the core of the rendering pipeline for path tracing is Ray Generation, since rays are generated from a start location and traced through the image to calculate a value of a pixel based on how light rays reflect around an image from light sources.  </p><p id="db9d533e-b46d-43ce-a4e3-c891fe649bdd" class="">To generate a ray, we first take the normalized image pixel coordinates and convert them to camera space coordinates. The camera space coordinates are based on the <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">-Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span><span>﻿</span></span> axis viewing direction for the camera. Using the horizontal and vertical field of view angles of the sensor, we can determine the camera space coordinates of the bottom left and top right of the normalized image <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">((0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">((</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>, respectively<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. We use these coordinates to interpolate the value of any arbitrary normalized image coordinate into camera space coordinates since both spaces are evenly-spaced rectangular grids.</p><p id="eb7b36b2-074f-473f-a3db-f7041b6d37ac" class="">Once we have the camera space coordinates, we generate a ray in camera space by shooting a ray from the camera, located at <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>, through the camera space coordinates we just calculated. Then, we convert this ray back to world space using a <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mi>w</mi></mrow><annotation encoding="application/x-tex">c2w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span><span>﻿</span></span> matrix (camera to world matrix) to convert the direction vector of the ray to world space and set the origin of the ray to the camera position in world space. Finally, we normalized the new world space ray, and that is our newly generated ray. </p><p id="a7e59a45-45ac-4b2d-bf05-60ed9caa9d79" class="">Our pixel sampling scheme utilizes the ray generation described above by sampling with multiple rays. To sample a pixel, we used Monte Carlo estimation to estimate the value of the pixel. We generated <code>ns_aa</code> random rays directed to random locations within the pixel. To generate the random location in the pixel, we used the <code>gridSampler</code> to sample the unit grid. Then, we called the function <code>est_radiance_global_illumination</code> on each ray to get an estimate of the radiance along the ray. We averaged these estimates to obtain the Monte Carlo estimate for the pixel’s radiance.</p><p id="136e2d32-d872-4e00-9bdd-3291d20fbb1e" class="">
</p><p id="d77c0971-ff56-42df-b477-f5a5a1f038ef" class=""><strong><strong>Primitive Intersection:</strong></strong></p><p id="7380d988-8dbd-427d-8e48-30298286285e" class="">Pixel sampling with ray generation utilizes the next part of our rendering pipeline, which is Primitive Intersection, since our goal is to understand where rays intersect our image, which is broken down into primitive structures. Knowing the time along the ray (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span>) of these primitive intersections helps calculate the radiances along rays.    </p><p id="42a2bb99-5065-4ffd-9667-e908b6ae4c46" class="">Two types of primitives we have ray intersection tests for are triangles and spheres (the algorithm for triangle intersection is described in detail below), and we are trying to find the earliest intersection along a ray. For triangles there can be at most 1 intersection <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> and for spheres, there can be at most 2 points, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">t_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">t_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. Each ray also tracks a value <code>max_t</code>, which is the earliest time of intersection with a primitive so far, and <code>min_t</code>, the start time of searching for an intersection along the ray. A valid intersection cannot be any further than <code>max_t</code> or closer than <code>min_t</code>. Thus, the intersection is valid if the ray intersects the primitive and the intersection points are between the ray’s <code>min_t</code> and <code>max_t</code>. We can then return <code>true</code> if there was a valid intersection and update the <code>max_t</code> to be the new closest intersection point for the ray.</p><p id="51f6aed1-1dee-45b8-8be7-09ed59806bcf" class="">
</p><p id="456683de-bba7-4c5d-86c1-995b0f4de5bf" class=""><em>Explain the triangle intersection algorithm you implemented in your own words.</em></p><p id="4dde336b-29f1-4915-9c22-8033137d0641" class="">For our triangle intersection algorithm, we used the Möller Trumbore Algorithm. This technique first checks for the ray-plane intersection to see if the ray intersects the plane containing the triangle, with the plane obtained from two sides of the triangle. We can check for ray-plane intersection by using the output <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> value and checking that <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t\geq0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span><span>﻿</span></span> to ensure this (a negative <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> value would mean that the ray was shot behind us). The algorithm also outputs two of the barycentric coordinates, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">b_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">b_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, from which we can analytically compute the third barycentric coordinate <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>b</mi><mn>1</mn></msub><mo>−</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">b_3 = 1-b_1-b_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. If <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">b_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">b_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>3</mn></msub><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">b_3 \in [0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span> then we know the intersection point is a valid point within the area enclosed by the 3 points of the triangle. </p><figure id="a6d99f0e-2640-45ec-961e-4e92a78e1ffb" class="image" style="text-align:center"><a href="images/Untitled.png"><img style="width:528px" src="images/Untitled.png"/></a><figcaption><em>Möller Trumbore Algorithm, Lecture 9 slides</em></figcaption></figure><p id="9f6853a8-c1ee-4434-982f-2d658d86d644" class="">
</p><p id="f7a2f349-0b1b-417a-b169-875f5723758c" class=""><em>Show images with normal shading for a few small .dae files.</em></p><div id="1b851566-c803-4d20-b14c-f2c9c84f2c6b" class="column-list"><div id="04072ca7-e2ab-4080-8198-d0af05c13d5b" style="width:50%" class="column"><figure id="375b1263-2eb9-4cdb-956a-6b7117279ab5" class="image"><a href="images/Untitled%201.png"><img style="width:800px" src="images/Untitled%201.png"/></a><figcaption><em>CBempty.dae</em></figcaption></figure><figure id="ea6bfe3d-852e-4bea-8630-9f8f8233172c" class="image"><a href="images/Untitled%202.png"><img style="width:800px" src="images/Untitled%202.png"/></a><figcaption><em>CBgems.dae</em></figcaption></figure></div><div id="1749d2c0-8c7a-45f3-8fd5-0a469b42f50c" style="width:50%" class="column"><figure id="6eafda83-061a-40d2-be99-d6772dc9f7fd" class="image"><a href="images/Untitled%203.png"><img style="width:800px" src="images/Untitled%203.png"/></a><figcaption><em>CBspheres_lambertian.dae</em></figcaption></figure><figure id="b6340f97-8ecf-4cad-8b82-582cc6b0ad90" class="image"><a href="images/Untitled%204.png"><img style="width:800px" src="images/Untitled%204.png"/></a><figcaption><em>bunny.dae</em></figcaption></figure></div></div><p id="ce29af7c-9048-4d73-89be-f45e4b12ec94" class="">
</p><h2 id="2a8cd817-70b2-40ea-a04a-0907d9790111" class="">Part 2: Bounding Volume Hierarchy</h2><p id="5ea8fecf-67ac-4891-85a4-2fee814f405a" class=""><em>Walk through your BVH construction algorithm. Explain the heuristic you chose for picking the splitting point.</em></p><p id="9a477121-a06f-4d94-ac6e-d6aa24c1c58a" class="">For our BVH algorithm, we started by expanding a starting bounding box to include all primitives in the list defined by the iterator given. This part was already given in the starter code. If the number of primitives in the current bounding box is no more than <code>max_leaf_size</code>, then this bounding box can be a leaf node and does not need to be further subdivided (the base case for our recursion). Otherwise, we need to split the node into a left and a right node based on a splitting heuristic (described below). Based on the splitting heuristic, we defined a custom comparator that would then sort the list of primitives accordingly. Afterward, we made 2 recursive calls to <code>construct_bvh</code> to create our left and right nodes. One recursive call takes in an iterator from the <code>start</code> of the sorted list to the split point, and the other considers the list from the split point to the <code>end</code>. </p><p id="31b99a77-6fbb-4233-9f8c-4951ea59eaca" class="">For our splitting heuristic, we decided to split along the average of the centroids on one of the axes. To determine which axis to split along, we used the bounding box around all of the primitives and chose the axis with the longest edge. We compared the centroids of the primitives to the point on the chosen axis to split our primitives into the left and right nodes. On the edge cases where primitives happened to overlap such that separating by centroid does not split the primitives and would place all primitives into one node, we then chose to split at the median object in the list of primitives. This is to prevent infinite recursion. </p><p id="7c9e6615-90b4-4807-a841-0a01e4500ce0" class="">
</p><p id="77e9054b-9c7a-4bd4-9487-de16f90aba13" class=""><em>Show images with normal shading for a few large .dae files that you can only render with BVH acceleration.</em></p><div id="c626f353-5415-4c35-85fd-0a243e1b2128" class="column-list"><div id="93e1fc01-13b4-48ed-8ad6-123b765ff8de" style="width:49.99999999999999%" class="column"><figure id="5af132e8-c600-431f-888c-584e432f2842" class="image"><a href="images/Untitled%205.png"><img style="width:800px" src="images/Untitled%205.png"/></a><figcaption><em>sky/CBlucy.dae </em>(hundreds of thousands of triangles)</figcaption></figure><figure id="7b6fc644-aa8f-47ba-912e-f40a69c6b4e8" class="image"><a href="images/Untitled%206.png"><img style="width:800px" src="images/Untitled%206.png"/></a><figcaption><em>meshedit/maxplanck.dae </em>(tens of thousands of triangles)</figcaption></figure></div><div id="69b84f4d-8790-461a-afcf-852ceebcc962" style="width:49.99999999999999%" class="column"><figure id="28e3daf3-e85f-4db5-aee9-5d6222bec473" class="image"><a href="images/Untitled%207.png"><img style="width:800px" src="images/Untitled%207.png"/></a><figcaption><em>meshedit/beast.dae </em>(tens of thousands of triangles)</figcaption></figure><figure id="839e263f-ba30-431f-ad6a-333ad7c092bd" class="image"><a href="images/Untitled%208.png"><img style="width:800px" src="images/Untitled%208.png"/></a><figcaption><em>meshedit/maxplanck.dae </em>(tens of thousands of triangles)</figcaption></figure></div></div><p id="a4208e86-686e-41e8-8492-ec23111ad813" class="">
</p><p id="d7a876fb-c644-4ead-9554-80efbeb7c583" class=""><em>Compare rendering times on a few scenes with moderately complex geometries with and without BVH acceleration. Present your results in a one-paragraph analysis.</em></p><p id="d7d22207-14b2-4697-b140-13dc03225a94" class="">Before implementing BVH acceleration, all primitives within the bounding box were being checked for intersections with all rays, so this would drastically slow down the rendering time. With BVH, we recursively split the bounding box into where leaf nodes only have a few primitives  (<code>max_leaf_size</code>), and only checked for ray-primitive intersection within leaf nodes that the ray intersects with. This is essentially eliminating the need to check for ray intersection in certain sections of the world bounding box, because if a ray does not intersect with a parent node, then it does not intersect with any children and thus can eliminate checking many leaf nodes with associated primitives. Additionally, once we hit BVH leaf nodes, with the use of setting a <code>min_t</code> and <code>max_t</code> for the ray, once a ray-primitive intersection is found, we can then eliminate the need to check for any ray-primitive intersections that are behind (farther along the ray) the first primitive we hit. We would then only accept closer primitives as valid intersections. When we rendered <em><em><em><em><em><em><em><em><em>cow.dae</em></em></em></em></em></em></em></em></em> (5856 primitives, 474773 rays) without BVH acceleration, it took ~107 seconds and an average of 1254 intersection tests per ray. After BVH intersection, <em><em><em><em><em><em><em><em><em>cow.dae </em></em></em></em></em></em></em></em></em>took ~0.6 seconds to render, averaging 10 intersection tests per ray. As you can see, this eliminated a lot of unnecessary intersection test calculations. When we tried rendering<em> CBlucy.dae</em> without BVH acceleration, it was too slow to wait for the rendering to complete 🥲. But after adding BVH, rendering <em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em>CBlucy.dae </em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em>took 11 seconds 😁.</p><p id="16808dee-b589-457c-956b-51f82061f768" class="">
</p><h2 id="f56579ce-8f63-4aac-8c42-031c86c00d82" class="">Part 3: Direct Illumination</h2><p id="26fd292d-5f72-4664-b634-460a371e10de" class=""><em>Walk through both implementations of the direct lighting function.</em></p><p id="88ebf9b0-27a4-4b77-8264-d072e70e6d41" class="">In both implementations, we made use of the Monte Carlo reflectance equation estimator. This process required sampling multiple rays originating from the point of interest in a certain direction to estimate the radiance entering the point. Using these samples and the reflectivity properties based on the Lambertian bidirectional scattering distribution function (BSDF), we compute how much of this incident radiance is reflected in the indicated direction. The difference between these techniques was how the incident radiance was sampled. </p><figure id="85ba6d22-02d5-4b57-a8dc-e55007fcdf53" class="image"><a href="images/Untitled%209.png"><img style="width:432px" src="images/Untitled%209.png"/></a><figcaption>reflection equation via Monte Carlo</figcaption></figure><p id="b15499fe-cf06-4745-81be-575d1ce2daf5" class=""><strong>Uniform</strong> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Hemisphere Sampling</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p><p id="ab5b5572-eafa-4a0e-a8e3-86101b6943e3" class="">The first implementation was estimating the direct lighting on the point by sampling in a hemisphere around the point. To do this, we sampled uniformly from a hemisphere (<code>hemisphereSampler</code>) <code>num_samples</code> times, and for each sample shot a ray from the hit point to the sample direction, checking for object intersections. If the ray intersected with a light source, we computed the incident radiance as the emission of the light source and then computed that ray’s contribution to the outgoing radiance by multiplying by the Lambertian BSDF term and the angle of the incident ray to the normal at the hit point. The output radiance is also normalized by the pdf of the sampling technique, which in this case is a uniform hemisphere so is a constant <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1} {2\pi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span>. Finally, all <code>num_samples</code> outgoing radiances are averaged.</p><p id="0fd9c329-529e-4a38-a4ce-f79e59d7da02" class=""><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Lighting Importance Sampling</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p><p id="ff163c9d-eb36-4542-af15-c2a6a2712e06" class="">The second implementation was to use importance sampling and estimate direct lighting by sampling all of the light sources directly. We used the <code>sample_L</code> function to sample the light source from the hit point and get the radiance, direction, distance to the light source from the hit point, and the probability of evaluating the pdf at the direction of the light source. With this information, we could cast a ray from the hit point to the light source and check for intersections. Instead of accumulating the light from intersections, we only consider cases where there are no intersections, meaning that there is nothing blocking the path of the light source to the hit point, and thus it should have light on it. For area light sources, we sampled them <code>ns_area_light</code> times and averaged that, but for point light sources, to be efficient and remove redundant calculations, we only sampled them once. We calculate the outgoing light with the same reflection equation as from the first method. </p><p id="a96f142c-6ba9-42d2-9642-0eed2047f6c4" class="">In both implementations, we had to be careful when working in object space vs world space (making sure rays were cast in world space).</p><p id="94e6842a-dfa6-4056-a18b-1c4a4ca78e0c" class="">
</p><p id="57093638-8c67-40ac-909a-395eac14b635" class=""><em>Show some images rendered with both implementations of the direct lighting function.</em></p><p id="c02e7677-ada5-4962-9e7c-c750a0dca66f" class=""><strong>Using </strong><strong><em>estimate_direct_lighting_hemisphere</em></strong><strong>:</strong></p><div id="c4fe44e4-9b03-42ea-bbd8-8809d77536f4" class="column-list"><div id="16e32c80-04d1-48cc-bedd-b647232e6d08" style="width:50%" class="column"><figure id="91b0ffc1-2da7-4ce0-8fd9-5e2eee9da117" class="image" style="text-align:right"><a href="images/Untitled%2010.png"><img style="width:480px" src="images/Untitled%2010.png"/></a><figcaption><em>CBbunny.dae </em>rendered with 8 threads, 16 samples per pixel, 8 samples per area light, at a resolution of 480x360</figcaption></figure></div><div id="6a64ca5c-d05a-43b0-9f0f-7179b063c8e9" style="width:50%" class="column"><figure id="8b13332c-0c0c-4c17-8b0a-1e9b8478263b" class="image" style="text-align:left"><a href="images/Untitled%2011.png"><img style="width:480px" src="images/Untitled%2011.png"/></a><figcaption><em>CBbunny.dae </em>rendered with 8 threads, 64 samples per pixel, 32 samples per area light, at a resolution of 480x360</figcaption></figure></div></div><figure id="58043d34-ba70-4cd4-bbfa-1c4fa3fc8eab" class="image"><a href="images/Untitled%2012.png"><img style="width:480px" src="images/Untitled%2012.png"/></a><figcaption><em>CBspheres_lambertian.dae </em>rendered with 8 threads, 64 samples per pixel, 32 samples per area light, and a resolution of 480x360</figcaption></figure><p id="7ee6f008-d176-4167-8c29-07dd113b8afd" class=""><strong>Using </strong><strong><em>estimate_direct_lighting_importance</em></strong><strong>:</strong></p><div id="028d5967-df93-4192-bb81-c435ffdd55dc" class="column-list"><div id="839be620-765d-4b31-9b62-1f59c74433c6" style="width:49.99999999999999%" class="column"><figure id="b2adefb4-c39c-40a0-b7a8-bad2284366a4" class="image" style="text-align:right"><a href="images/Untitled%2013.png"><img style="width:480px" src="images/Untitled%2013.png"/></a><figcaption><em>CBbunny.dae </em>rendered with 8 threads, 1 sample per pixel, 1 sample per area light, at a resolution of 480x360</figcaption></figure><figure id="9e96088e-3d4c-4297-8bd8-1d5e61407809" class="image" style="text-align:right"><a href="images/Untitled%2014.png"><img style="width:480px" src="images/Untitled%2014.png"/></a><figcaption><em>CBspheres_lambertian.dae </em>rendered with 8 threads, 64 samples per pixel, 32 samples per area light, at a resolution of 480x360</figcaption></figure></div><div id="1390e53b-d8e1-4516-a67f-39e47be13e96" style="width:49.99999999999999%" class="column"><figure id="838ee2e2-d2e4-4082-a5d1-2c41390ae50a" class="image" style="text-align:left"><a href="images/Untitled%2015.png"><img style="width:480px" src="images/Untitled%2015.png"/></a><figcaption><em>CBbunny.dae </em>rendered with 8 threads, 64 samples per pixel, 32 samples per area light, at a resolution of 480x360</figcaption></figure><figure id="2b1e971c-cd9e-400b-9aa9-deeb8ee9b31f" class="image"><a href="images/Untitled%2016.png"><img style="width:480px" src="images/Untitled%2016.png"/></a><figcaption><em>banana.dae</em> rendered with 8 threads, 64 samples per pixel, 32 samples per area light, at a resolution of 480x360</figcaption></figure></div></div><figure id="985038f1-6efc-44bb-a113-24c2adcbbb86" class="image" style="text-align:center"><a href="images/Untitled%2017.png"><img style="width:480px" src="images/Untitled%2017.png"/></a><figcaption><em>dragon.dae  </em>rendered with 8 threads, 64 samples per pixel, 32 samples per area light, at a resolution of 480x480</figcaption></figure><p id="58898dfb-dba8-4273-8f40-98dc77b1f4a6" class=""><em>Focus on one particular scene with at least one area light and compare the noise levels in soft shadows when rendering with 1, 4, 16, and 64 light rays (the </em><em><code>l</code></em><em> flag) and with 1 sample per pixel (the </em><em><code>s</code></em><em> flag) using light sampling, </em><em><strong>not</strong></em><em> uniform hemisphere sampling.</em></p><p id="73ea7ba4-2950-4b69-aa50-63ebab4ca2e7" class="">Renderings of <em>CBspheres_lambertian.dae:</em></p><div id="650287c8-c427-4778-b9fa-da932e6fbb48" class="column-list"><div id="772de78c-10ec-458a-aa53-10ebcdd09e6e" style="width:50%" class="column"><figure id="44afcd17-af9c-47da-aa45-fc03ec279628" class="image" style="text-align:right"><a href="images/Untitled%2018.png"><img style="width:480px" src="images/Untitled%2018.png"/></a><figcaption>1 ray</figcaption></figure><figure id="1d12da39-9fb6-4a70-a51c-d5e9a1878736" class="image" style="text-align:right"><a href="images/Untitled%2019.png"><img style="width:480px" src="images/Untitled%2019.png"/></a><figcaption>16 rays</figcaption></figure><p id="eb4bd1b2-e565-44f6-b646-a1ce35e4cae3" class="">
</p></div><div id="209c0e1e-4b37-4b0e-a65f-a4b220ce5e98" style="width:50%" class="column"><figure id="a37e4e4b-b91d-4461-aa23-bf9a3b1319d0" class="image" style="text-align:left"><a href="images/Untitled%2020.png"><img style="width:480px" src="images/Untitled%2020.png"/></a><figcaption>4 rays</figcaption></figure><figure id="2517c51b-947d-404d-8294-02183e8414cd" class="image" style="text-align:left"><a href="images/Untitled%2021.png"><img style="width:480px" src="images/Untitled%2021.png"/></a><figcaption>64 rays</figcaption></figure></div></div><p id="90d0af54-df8f-4cbb-be81-5bb790e9e7cf" class=""><em>Compare the results between uniform hemisphere sampling and lighting sampling in a one-paragraph analysis.</em></p><p id="cd31fe4f-b1b5-4c7e-9d1e-bcc75fd4f589" class="">Overall, the lighting sampling performs much better than the uniform hemisphere sampling when comparing renderings with the same number of light rays and samples per pixel. Furthermore, we noticed lighting sampling is capable of generating a decent rendering at very low parameters (i.e. 1 light ray and 1 sample per pixel) while uniform hemisphere sampling failed to render anything recognizable. There are a couple of reasons for the limitations of uniform hemisphere sampling. The first is that because we sample in random directions across the hemisphere, we miss most of the point light sources since the probability of hitting a point light source with uniform sampling is low. We can eliminate the issue of missing light sources in light sampling because we sample each light source directly (this allows us to render the non-Cornell Box images since they only have point lights). Furthermore for all light sources in general, since lighting sampling utilizes importance sampling and narrows our sampling range to only the lights, we reduce overall noise from the non-light source samples.</p><p id="4438add5-19ba-487e-87b7-017f180735db" class="">
</p><h2 id="3dd802d2-3a76-479c-9b14-fbc1b36c70b0" class="">Part 4: Global Illumination</h2><p id="e08cd7aa-4a5e-4f78-afdf-390e809abd3b" class=""><em>Walk through your implementation of the indirect lighting function.</em></p><p id="4a9ea549-b7dc-47ab-a4a5-8d65d03247fa" class="">In order to render the visual richness that comes with global illumination, we implemented indirect lightning, which encompasses light reflected after multiple bounces. To do this, we implemented <code>at_least_one_bounce_radiance</code>, which recursively calls itself based on the set <code>max_ray_depth</code> and in each step, makes use of <code>one_bounce_radiance</code> to incorporate any light directly reflected from a light source (single bounce). A generalized pseudocode for the algorithm is shown below, as well as a visual representation of ray tracing for more than 1 bounce of light (2 bounces from 2 light ray sources in this case).</p><div id="3ad2c29f-7976-4d65-a5a0-fcebbad800b2" class="column-list"><div id="02f6a6d4-2d16-43f9-a3d8-9a974f94b81d" style="width:50%" class="column"><figure id="bc330b76-2cb8-4dba-bd56-1f333d253482" class="image"><a href="images/Untitled%2022.png"><img style="width:810px" src="images/Untitled%2022.png"/></a><figcaption>CS184 Lecture 13, Spring 2023</figcaption></figure></div><div id="8f5a851b-9df4-4fc0-b21d-4d53e73f06be" style="width:50%" class="column"><figure id="b033fc9e-e1d2-4f3b-8259-be1b2d4b7240" class="image" style="text-align:left"><a href="images/Untitled%2023.png"><img style="width:576px" src="images/Untitled%2023.png"/></a><figcaption>CS184 Lecture 13, Spring 2023</figcaption></figure><p id="1a95c85b-f8d1-47cb-8ca0-169b54d9c57b" class="">
</p></div></div><p id="70f649f6-b0db-448c-8467-c7a71b3bbfc3" class="">Breaking down the algorithm, in each recursive call, we first take the one-bounce radiance at a point <code>p</code> in a direction <code>w_o</code> which incorporates point lights and area lights directly shining on the point. In the recursive case, we also include how much light shining on other points such as <code>p&#x27;</code> and <code>p&#x27;&#x27;</code> is also reflected onto <code>p</code> through the use of the reflectance equation described in task 3 (direct illumination).  This allows us to incorporate light reflected onto <code>p</code> that was either reflected by other points onto <code>p&#x27;</code> and <code>p&#x27;&#x27;</code> or shined onto those points directly.  </p><p id="eda58150-f35a-4dcf-a90a-4ccd6be5e270" class="">There are a few other details we also include. First, in practice, light bounces infinitely so this recursion would never end. Thus, in our implementation, we include a stop condition based on the maximum number of bounces we want for the given rendering (the <code>max_ray_depth</code>). Additionally, to further reduce the computational intensity, we add another stopping condition called Russian Roulette. In each recursive call, we terminate the recursion with some preset probability instead of always implementing recursion to the <code>max_ray_depth</code> number of bounces. This means not every ray we trace actually reaches the <code>max_ray_depth</code> number of bounces when we are estimating the global illumination. To account for this potential early stopping, we also normalize the reflectance equation by the conditional probability of continuing (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">cdf</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span></span></span></span></span><span>﻿</span></span>). In our implementation of Russian Roulette, we chose to terminate the recursion with a probability <code>0.35</code>.</p><p id="ae9b8f84-99e5-4d70-9b35-326856f14a3f" class="">
</p><p id="7ca3e6d1-5955-4875-b179-f4fc73b0abfb" class=""><em>Show some images rendered with global (direct and indirect) illumination. Use 1024 samples per pixel.</em></p><p id="732ff1cb-5268-4096-b549-97f897d8127b" class="">Below are some rendered scenes with indirect lighting included. Note that the overall images are brighter than without indirect lighting (the images from task 3) and most notably for renderings of images with a Cornell Box, the ceiling no longer appears black since we can account for light bouncing from the area light on the ceiling to the floor and object and back up to the ceiling again. </p><div id="69e20c0d-acc5-4825-8c35-b6327e4e6e2d" class="column-list"><div id="4dbf9ae9-643f-4cb7-ac12-540bf42dedf5" style="width:49.99999999999999%" class="column"><figure id="963b4320-1c44-4319-9001-f4aee7c19dab" class="image" style="text-align:right"><a href="images/CBspheres_lambertian_1024_16_global.png"><img style="width:480px" src="images/CBspheres_lambertian_1024_16_global.png"/></a><figcaption><em>CBspheres_lambertian.dae</em> with 8 threads, 1024 samples per pixel, 16 samples per area light, and a max_ray_depth of 5.</figcaption></figure><figure id="d5b9ec93-4473-4faa-910e-79ab37639f52" class="image" style="text-align:right"><a href="images/banana.png"><img style="width:480px" src="images/banana.png"/></a><figcaption><em>banana.dae</em> with 8 threads, 1024 samples per pixel, 4 samples per area light, and a max_ray_depth of 2.</figcaption></figure></div><div id="c7cc8cbe-714e-4abb-b02a-0aa5d7793b01" style="width:49.99999999999999%" class="column"><figure id="a59e2f03-ea99-4dc8-be98-8f2499930ceb" class="image" style="text-align:left"><a href="images/CBbunny_1024_4_2_global.png"><img style="width:480px" src="images/CBbunny_1024_4_2_global.png"/></a><figcaption><em>CBbunny.dae</em> with 8 threads, 1024 samples per pixel, 4 samples per area light, and a max_ray_depth of 2.</figcaption></figure><figure id="e7249b68-43d8-40e0-8433-62c028996109" class="image" style="text-align:left"><a href="images/Untitled%2024.png"><img style="width:480px" src="images/Untitled%2024.png"/></a><figcaption><em>CBdragon.dae </em>with 8 threads, 1024 samples per pixel, 4 samples per area light, and a max_ray_depth of 2.</figcaption></figure></div></div><p id="8351de29-73bb-4b30-9b2c-5c3c06caf7ab" class="">
</p><p id="4b7600f7-ebfa-4159-9321-8d1b4e3e5bc0" class=""><em>Pick one scene and compare rendered views first with </em><em><strong>only</strong></em><em> direct illumination, then </em><em><strong>only</strong></em><em> indirect illumination. Use 1024 samples per pixel.</em></p><p id="a5853998-e3c2-43e3-9370-c52bfd0c4542" class="">The different renderings of the spheres below demonstrate the relative contributions of direct and indirect lighting. On the left, we have direct lighting only (zero and one bounce), which is similar to task 3 renderings. On the right, we have 2 renderings of indirect lighting, only with different numbers of bounces (<code>max_ray_depth</code> of 2 and 4). You can see how by increasing the <code>max_ray_depth</code>, the Cornell Box gets lighter, since light is bouncing off the walls a few more times. To generate these images with only indirect illumination, we took the global illumination radiance computation and subtracted the direct illumination radiance contribution. </p><div id="ae57403d-c2c5-4587-a50f-9bc2b23fa148" class="column-list"><div id="208eaac3-49e1-4ba0-98db-a4bea9136081" style="width:33.33333333333333%" class="column"><figure id="f759bf01-6af8-457d-b9b6-0f7bea884591" class="image" style="text-align:center"><a href="images/CBspheres_direct.png"><img style="width:480px" src="images/CBspheres_direct.png"/></a><figcaption>direct illumination only: <em>CBspheres_lambertian.dae </em>with 8 threads, 1024 samples per pixel, and 4 samples per area light.<em> </em></figcaption></figure></div><div id="a29ebb47-bc31-421c-a622-acda08ed881b" style="width:33.33333333333333%" class="column"><figure id="cd9e67e8-ba39-4258-a724-d7218efcd08b" class="image"><a href="images/Untitled%2025.png"><img style="width:480px" src="images/Untitled%2025.png"/></a><figcaption>indirect illumination only: <em>CBspheres_lambertian.dae </em>with 8 threads, 1024 samples per pixel, 4 samples per area light, and a max ray depth of 2.</figcaption></figure></div><div id="5db7e995-0b86-4e9f-bada-defe50ae8c20" style="width:33.33333333333333%" class="column"><figure id="3e1b2bcb-2113-4896-bcb8-4dfcf94ec635" class="image"><a href="images/Untitled%2026.png"><img style="width:480px" src="images/Untitled%2026.png"/></a><figcaption>indirect illumination only: <em>CBspheres_lambertian.dae </em>with 8 threads, 1024 samples per pixel, 4 samples per area light, and a max ray depth of 4.</figcaption></figure></div></div><p id="68c73175-fc24-4890-99ea-22e5f3134525" class="">
</p><p id="75791016-c6d4-428c-8260-1d6b8f189b8e" class=""><em>For CBbunny.dae, compare rendered views with </em><em><code>max_ray_depth</code></em><em> set to 0, 1, 2, 3, and 100 (the </em><em><code>m</code></em><em> flag). Use 1024 samples per pixel.</em></p><p id="8365b9b4-a120-41dc-901f-181718164ad0" class="">Finally, we have comparisons of the Cornell Box bunny with different numbers of <code>max_ray_depth</code> or max number of bounces. Most notably, zero-bounce only shows the light sources, one-bounce illuminates the bunny while the ceiling remains dark, and multiple bounces (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span>) illuminates the ceiling and then all objects appear much brighter.   </p><p id="d22cac8c-57a9-4304-b335-fc6add7590aa" class="">All the following renderings of <em>../dae/sky/CBbunny.dae </em>were rendered with 8 threads, 1024 samples per pixel, 4 samples per area light, and resolution of 480x360 with the <code>max-ray-depth</code> (-m flag) adjusted accordingly.</p><div id="455355fa-c94c-4cd1-acaa-255ca10249dd" class="column-list"><div id="e7ca06b8-ef1e-4e3a-8745-cf667589e799" style="width:50%" class="column"><figure id="218bf89f-7089-4972-bc5b-17cb3dcf981a" class="image" style="text-align:right"><a href="images/CBbunny_1024_4_0_global.png"><img style="width:432px" src="images/CBbunny_1024_4_0_global.png"/></a><figcaption>m = 0</figcaption></figure></div><div id="e6ba0909-dcc4-4fce-b6a1-9a8d0fd0b451" style="width:50%" class="column"><figure id="6e330cbd-05a0-4607-9978-983a5a003135" class="image" style="text-align:left"><a href="images/CBbunny_1024_4_1_global.png"><img style="width:432px" src="images/CBbunny_1024_4_1_global.png"/></a><figcaption>m = 1</figcaption></figure></div></div><div id="d430959b-3c1c-4350-a7b7-59935a2e20c4" class="column-list"><div id="785d97f4-5b81-410a-9ab7-7cb919d05546" style="width:33.33333333333333%" class="column"><figure id="eeaccdc9-c2d3-4a2e-9b50-3e8cc470372a" class="image" style="text-align:center"><a href="images/CBbunny_1024_4_2_global%201.png"><img style="width:480px" src="images/CBbunny_1024_4_2_global%201.png"/></a><figcaption>m = 2</figcaption></figure></div><div id="af779623-1089-46cb-98e0-fa3edfb6ac9b" style="width:33.33333333333333%" class="column"><figure id="9fc09995-449f-4ccf-affa-80e68246114d" class="image" style="text-align:center"><a href="images/Untitled%2027.png"><img style="width:480px" src="images/Untitled%2027.png"/></a><figcaption>m = 3</figcaption></figure></div><div id="4c440ac3-3911-492b-b78f-dce7750d35e2" style="width:33.33333333333333%" class="column"><figure id="4ff1140a-d529-4fc8-b9d0-d98e83c6fce0" class="image" style="text-align:center"><a href="images/Untitled%2028.png"><img style="width:480px" src="images/Untitled%2028.png"/></a><figcaption>m = 100</figcaption></figure></div></div><p id="292863de-ed38-490a-af66-1ad864a0489f" class=""><em>Pick one scene and compare rendered views with various sample-per-pixel rates, including at least 1, 2, 4, 8, 16, 64, and 1024. Use 4 light rays.</em></p><p id="57355e50-a867-4171-adb4-4a3f8b3de1a7" class="">In this part, we incorporated indirect lighting while highlighting the differences between different numbers of rays sampled per pixel. Note that as we increase samples per pixel, the samples are more likely to accurately incorporate reflections from light sources, especially point lights, which reduces noise significantly. </p><p id="8fab419e-23b0-4314-8633-5873c906d2bf" class="">All the following renderings of <em>CBspheres_lambertian.dae</em> were rendered with 8 threads, 4 samples per area light, a <code>max_ray_depth</code> of 2, and a resolution of 480x360 with the sample-per-pixel rates (-s flag) adjusted accordingly.</p><div id="1abc7f5b-b2aa-4488-af6a-29337c489d83" class="column-list"><div id="b1b3b845-dc75-4477-9914-7e5846fcbab9" style="width:25%" class="column"><figure id="8df0129d-c4d9-4f24-bdb4-57ae412ede03" class="image"><a href="images/CBspheres_1_4_2_global.png"><img style="width:480px" src="images/CBspheres_1_4_2_global.png"/></a><figcaption>1 sample-per-pixel</figcaption></figure></div><div id="ab84abc7-d279-48fd-bf4b-b0fd0e7fc83a" style="width:25%" class="column"><figure id="2f018812-eb38-4511-8943-ecf00e28f3f7" class="image"><a href="images/CBspheres_2_4_2_global.png"><img style="width:480px" src="images/CBspheres_2_4_2_global.png"/></a><figcaption>2 samples-per-pixel</figcaption></figure></div><div id="4178bdcf-224c-459a-b09b-9b8cc2d50f61" style="width:25%" class="column"><figure id="48cf4f09-e422-4af4-8e9b-bc7400559a44" class="image"><a href="images/CBspheres_4_4_2_global.png"><img style="width:480px" src="images/CBspheres_4_4_2_global.png"/></a><figcaption>4 samples-per-pixel</figcaption></figure></div><div id="35e8bd01-3195-45b2-a8a2-c7c5236b5cd0" style="width:25%" class="column"><figure id="49867e5b-6149-49dd-b56e-b0c4654768a5" class="image"><a href="images/CBspheres_4_4_2_global%201.png"><img style="width:480px" src="images/CBspheres_4_4_2_global%201.png"/></a><figcaption>8 samples-per-pixel</figcaption></figure></div></div><div id="ad277c62-6a50-44d2-96ef-e5e1599b922d" class="column-list"><div id="4b891bf8-47da-4595-87f4-a4af6e25e42e" style="width:33.33333333333333%" class="column"><figure id="0a35001b-cefa-4ad9-b86a-019eb1cfa835" class="image"><a href="images/CBspheres_16_4_2_global.png"><img style="width:480px" src="images/CBspheres_16_4_2_global.png"/></a><figcaption>16 samples-per-pixel</figcaption></figure></div><div id="92786984-0423-4171-b91b-8cc8adc86a31" style="width:33.33333333333333%" class="column"><figure id="538a545e-cdcb-488e-afed-3fb13db37333" class="image"><a href="images/CBspheres_64_4_2_global.png"><img style="width:480px" src="images/CBspheres_64_4_2_global.png"/></a><figcaption>64 samples-per-pixel</figcaption></figure></div><div id="a5191915-41f0-424a-bfc8-5cc2e21c656e" style="width:33.33333333333333%" class="column"><figure id="5fbef8a2-497b-46c1-97f5-729a46c16f1a" class="image"><a href="images/CBspheres_1024_4_2_global.png"><img style="width:480px" src="images/CBspheres_1024_4_2_global.png"/></a><figcaption>1024 samples-per-pixel</figcaption></figure></div></div><h2 id="a71b7674-1ac3-4c26-b00c-bb6b6b5bdcf9" class="">Part 5: Adaptive Sampling</h2><p id="1dfdd133-45d3-4964-a83b-3032e4d2bba5" class=""><em>Explain adaptive sampling. Walk through your implementation of the adaptive sampling.</em></p><p id="bcf7a154-4d77-492e-9c85-235cd16a349f" class="">In the previous section, we noticed how an increased sampling rate decreases noise. However, in reality, it is not necessary to need to sample every pixel at a high sample rate because some pixels converge faster with low sampling rates (for example, the walls). With adaptive sampling, we concentrate high sample rates at more difficult parts of the image (places that take longer to converge), which can allow us to achieve a balance of rendering a high-quality image while reducing some of the computational intensity of a fixed high sampling rate (faster rendering). </p><p id="1648b6b0-c3e3-4a54-b65e-0222537455fd" class="">In order to do this, as a given pixel is being sampled, we keep track of the mean and variance of the radiances of all the samples so far. Using this information we can terminate when we believe the majority of our samples fall within a certain narrow range with high confidence (and thus we believe future samples won’t drastically change the outcome). Specifically, in our case, we solve for the 95% confidence interval being a small enough range once the variance is not large. </p><p id="d7a1a47e-d4c5-4a07-8d57-c30b1c9c7140" class="">Mathematically this works out as follows:</p><p id="9e0d73e1-3453-41e6-b6a1-48b28cdb743e" class="">Given the mean <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span></span><span>﻿</span></span> and the variance <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> after <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span>﻿</span></span> samples, we define <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>1.96</mn><mo>⋅</mo><mfrac><mi>σ</mi><msqrt><mi>n</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">I = 1.96 \cdot \frac{\sigma}{\sqrt n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1.96</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.233392em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6258665em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8059050000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal mtight" style="padding-left:0.833em;">n</span></span><span style="top:-2.765905em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.234095em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span>. Given some <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mi>T</mi><mi>o</mi><mi>l</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">maxTolerance</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span></span></span></span></span><span>﻿</span></span>, When <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>≤</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>T</mi><mi>o</mi><mi>l</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>⋅</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">I \leq maxTolerance \cdot \mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span></span><span>﻿</span></span>, we are 95% confident the average illuminance is within <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>μ</mi><mo>−</mo><mi>I</mi><mo separator="true">,</mo><mi>μ</mi><mo>+</mo><mi>I</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mu - I, \mu + I]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span>. </p><p id="40616799-c2af-43f6-8a50-a3f4e5d35bd2" class="">To implement adaptive sampling we modified the <code>raytrace_pixel</code> function to keep track of 2 variables <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">s1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">s2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span></span></span></span></span><span>﻿</span></span> as shown below for easy computation of mean and variance at any point in the sampling for a given pixel. Given another parameter <code>samplesPerBatch</code>, we calculate the mean and variance and perform the confidence interval check for the <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span>﻿</span></span> samples so far (formulas below). If the confidence interval is met, then we stop sampling and only average the samples already obtained. </p><div id="3c92c2b6-c5a0-4cf6-83b0-a6163ef65e0c" class="column-list"><div id="e7d0f07b-bdf6-4e2f-b165-8e8cec58c43f" style="width:43.75000000000001%" class="column"><figure id="20fc7066-a4e4-4c17-b2fe-1cd830ec1304" class="image" style="text-align:right"><a href="images/Untitled%2029.png"><img style="width:192px" src="images/Untitled%2029.png"/></a></figure></div><div id="8cecb2c9-3ec3-4d03-8644-c82f1a1cc138" style="width:56.25%" class="column"><figure id="c5d06e8c-e140-483c-91fe-f2403af14338" class="image"><a href="images/Untitled%2030.png"><img style="width:336px" src="images/Untitled%2030.png"/></a></figure><p id="68885838-32fe-4dfe-947d-b582d6bcd830" class="">
</p></div></div><p id="b8cc42d0-daa5-4653-8fe7-6c7d4b9975b6" class="">Additionally, to produce a nice visualization of how the sampling rate varies by pixel, we record the number of samples per pixel we used each time. This was used to generate the heat maps shown below, where red is the highest sample rate and blue is the lowest.</p><p id="d53bbdd8-0297-40b8-8674-1441603e4f6c" class=""><em>Pick two scenes and render them with at least 2048 samples per pixel. Show a good sampling rate image with clearly visible differences in sampling rate over various regions and pixels. Include both your sample rate image, which shows your how your adaptive sampling changes depending on which part of the image you are rendering, and your noise-free rendered result. Use 1 sample per light and at least 5 for max ray depth.</em></p><p id="424e350c-98c7-484d-a528-07ecdacc85be" class="">All renderings below are at a resolution of 480x360, created using 8 threads, 2048 samples per pixel, an adaptive sampling batch size of 64, adaptive sampling tolerance of 0.05, 1 sample per area light, and a max ray depth of 5.</p><div id="f99bb2f6-db1a-4c27-b4f5-29b68595c8c8" class="column-list"><div id="ff9fcc8a-62d6-48da-923c-ce67359e500c" style="width:50%" class="column"><figure id="247a5430-e683-4c02-aa52-7829b097d39c" class="image" style="text-align:right"><a href="images/Untitled%2031.png"><img style="width:480px" src="images/Untitled%2031.png"/></a><figcaption><em>CBspheres_lambertian.dae</em></figcaption></figure><figure id="2b535063-3267-411f-a4bc-402b3c1b45b5" class="image" style="text-align:right"><a href="images/bunny_2048_64_05_1_5_adaptive.png"><img style="width:480px" src="images/bunny_2048_64_05_1_5_adaptive.png"/></a><figcaption><em>CBbunny.dae</em></figcaption></figure><figure id="68cbcc9a-88e2-426d-94ff-aad829da1362" class="image" style="text-align:right"><a href="images/Untitled%2032.png"><img style="width:480px" src="images/Untitled%2032.png"/></a><figcaption><em>dragon.dae</em></figcaption></figure></div><div id="79f282d9-8999-48fc-91b2-083d8877547d" style="width:50%" class="column"><figure id="9f67f0d0-d703-459e-988a-46a36dd65ace" class="image"><a href="images/Untitled%2033.png"><img style="width:480px" src="images/Untitled%2033.png"/></a><figcaption>sample rate for <em>CBspheres_lambertian.dae</em></figcaption></figure><figure id="82836ae5-67a6-44b5-8bfb-26858b64ad7f" class="image"><a href="images/bunny_2048_64_05_1_5_adaptive_rate.png"><img style="width:480px" src="images/bunny_2048_64_05_1_5_adaptive_rate.png"/></a><figcaption>sample rate for <em>CBbunny.dae</em></figcaption></figure><figure id="045d385f-9b5b-48ac-8ba9-065cfbd25e66" class="image"><a href="images/Untitled%2034.png"><img style="width:480px" src="images/Untitled%2034.png"/></a><figcaption>sample rate for <em>dragon.dae</em></figcaption></figure></div></div><p id="9137ddfa-ddef-4f87-975d-151c118ea488" class="">
</p><p id="f8adc072-8bae-48f5-9681-87271cc4df3d" class=""><em>At the end, if you worked with a partner, please write a short paragraph together for your final report that describes how you collaborated, how it went, and what you learned.</em></p><p id="096e0b3a-2656-4708-9983-4d467079fab3" class="">This was a really fun and fulfilling project! We worked as partners on this project and overall, our workflow was very smooth. We generally did all the code together with one person actively compiling/building and allowing the other person to write code through Visual Studio live share. For remote work sessions, we also used Zoom to allow the other person to see the renderings as they were created. Overall, working on code together instead of a divide and conquer approach allowed us to fully understand the concepts, easily debug code the other person was writing, and be on the same page with our designs/algorithms. Throughout the process, we gained a deeper understanding of class concepts and also how to optimize our computers for difficult renderings because they can take a very long time.  </p><p id="deca1a7d-d90b-4e2f-8ca8-fa4575b64590" class="">
</p><p id="8547450a-cada-4205-981c-1e3fc736cb88" class=""><strong>Website URL</strong>: <a href="https://srisainachuri.github.io/cs184-project-portfolio/proj3-1/index.html">https://srisainachuri.github.io/cs184-project-portfolio/proj3-1/index.html</a></p><p id="57d3e826-4ec6-445c-9d1f-0c2a10ebdba4" class="">
</p></div></article></body></html>
